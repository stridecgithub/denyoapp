<div class="ionic2-calendar" [ngClass]="sizeClass">
  <div class="ionic2-cal-topnav">
    <div class="month-selection" style="background-color:#00569F;color:white">
      <button style=" background:url(img/left_arrow.png) no-repeat center ;width:40px;height:40px;" class="switch-month-button"
        (click)="plusMonth(-1)"></button>
      <div style="width: 80%;height: 40px;position: relative;margin-left: 28%;top: 10px;">
        <!--ion-select (ngModelChange)="setDateSelectionMonth($event)" [(ngModel)]="ctrl.selectedMonth">
          <ion-option *ngFor="let m of months" [value]="m">{{m}}</ion-option>
        </ion-select-->{{monthTitle}} - {{yearTitle}}
      </div>
      <button style=" background:url(img/right_arrow.png) no-repeat center ;width:40px;height:40px;" class="switch-month-button"
        (tap)="plusMonth(1)"></button>
    </div>
  </div>
  <div class="main-view">
    <div class="ionic2-cal-month-view">
      <div style="background-color: rgb(65,139,200);
    color: white;" class="ionic2-cal-item ionic2-cal-header" *ngFor="let wd of weekDays">
        {{wd}}
      </div>
      <!-- Data attribute idx should be enough, cause then we can retrieve the date, etc from the idx... -->
      <button class="ionic2-cal-item" [attr.data-idx]="i" [attr.data-dayofmonth]="d.date.date()" [attr.data-month]="d.date.month()"
        [attr.data-year]="d.date.year()" [id]="'month-grid-day-' + i" *ngFor="let d of ctrl.monthView.days; let i = index"
        [ngClass]="{'out-of-current-month': (d.date.isBefore(ctrl.monthView.firstDayOfMonth) || d.date.isAfter(ctrl.monthView.lastDayOfMonth))}"
        (tap)="selectDate(d, $event)" (press)="monthDayGridCellOnPress(d, $event)">
            <ul class="event-list" [dragula]='"first-bag"' [dragulaModel]='d.events'>
        <button 
          class="event-list-item 
          {{e.endDate.getDate() !== d.date.date() ? 'does-continue' : ''}} 
          {{e.startDate.getDate() !== d.date.date() ? 'is-continued' : ''}}
          {{(e.endDate.getDate() !== d.date.date()) || (e.startDate.getDate() !== d.date.date()) ? 'multi-span-' + e.id : ''}}
          {{activeDragGroup === 'multi-span-' + e.id ? 'active-group-drag' : ''}}" 
          [ngClass]="e?.class" 
          *ngFor="let e of d.events"
          [id]="e.id"
          (tap)="eventOnClick(e, $event)"
          (press)="eventOnPress(e, $event)">
          <span *ngIf="e.startDate.getDate() === d.date.date()" class="ionic2-event-time">{{e.startDate | date:"HH:mm"}}: </span>
          <!--span *ngIf="e.startDate.getDate() !== d.date.date()">...</span--> 
          <!--<i [ngClass]="e?.icon"></i>-->
          <!--ion-icon [name]="e?.icon" [ngStyle]="e.iconStyle"></ion-icon-->

         <!-- {{e.eventlength}} 
          {{e.servicelength}} 
          {{e.alarmlength}}-->
<!--{{e.startDate.getDate()}}
{{d.date.date()}}-->
<p *ngFor="let h of e.highlightdots; let i = index">
  <!--Date:{{h.date}}
  Calendar Date: {{d.date.year()}} - {{d.date.month()}} -{{d.date.date()}}
  Highlighted date:{{h.date}}
  Highlighted class:{{h.class}}--> 
<!-- 1 Alarm , Service and Events alarm_service_event --  >
<span class="{{h.class}}" *ngIf="h.class=='alarm_service_event' && i==0" style="font-size:32pt;color:rgb(90,192,217);">.</span><!-- Event-->
<!-- <span class="{{h.class}}" *ngIf="h.class=='alarm_service_event' && i==0"  style="font-size:32pt;color:rgb(63,139,197);"></span>Service-->
<!-- <span class="{{h.class}}" *ngIf="h.class=='alarm_service_event' && i==0"style="font-size:32pt;color:#ECAE4B;"></span>Alarm-->
<!-- 1 Alarm , Service and Events-->


<!-- 2 Alarm and Service alarm_service -->
<span class="{{h.class}}" *ngIf="h.class=='alarm_service' && i==0"  style="font-size:32pt;color:rgb(63,139,197);">.</span><!-- Service-->
<!-- <span class="{{h.class}}" *ngIf="h.class=='alarm_service' && i==0"style="font-size:32pt;color:#ECAE4B;"></span>Alarm-->
<!-- 2 Alarm and Service-->



<!-- 3 Alarm and Event alarm_event --  >
<span class="{{h.class}}" *ngIf="h.class=='alarm_event' && i==0" style="font-size:32pt;color:rgb(90,192,217);">.</span><!-- Event-->
<!-- <span class="{{h.class}}" *ngIf="h.class=='alarm_event' && i==0"style="font-size:32pt;color:#ECAE4B;"></span>Alarm-->
<!-- 3  Alarm and Event -->



<!-- 4 Event and Service-->
<span class="{{h.class}}" *ngIf="h.class=='service_event' && i==0" style="font-size:32pt;color:rgb(90,192,217);">.</span><!-- Event-->
<!-- <span class="{{h.class}}" *ngIf="h.class=='service_event' && i==0"  style="font-size:32pt;color:rgb(63,139,197);"></span>Service-->
<!-- 4 Event and Service-->

<!--{{d.date.year()-d.date.month()-d.date.date()}}-->
<!-- 5 Alarm Only-->
<span class="{{h.class}}" *ngIf="h.class=='alarm' && i==0" style="font-size:32pt;color:#ECAE4B;">.</span><!-- Alarm-->
<!-- 5 Alarm Only-->


<!-- 6 Service Only-->
<span class="{{h.class}}" *ngIf="h.class=='service' && i==0"  style="font-size:32pt;color:rgb(63,139,197);">.</span><!-- Service-->
<!-- 6 Service Only-->



<!-- 7  Event Only-->
<span class="event-continued-ellipsis" *ngIf="h.class=='event' && i==0" style="font-size:32pt;color:rgb(90,192,217);">.</span><!-- Event-->
<!-- 7 Event Only-->



















</p>
           <!--span class="event-continued-ellipsis" *ngIf="e.eventlength>0" style="font-size:32pt;color:rgb(91,192,220);">.</span>

            <span class="event-continued-ellipsis" *ngIf="e.servicelength>0"  style="font-size:32pt;color:rgb(65,139,200);">.</span>

             <span class="event-continued-ellipsis" *ngIf="e.alarmlength>0"  style="font-size:32pt;color:rgb(239,173,77);">.</span-->

          <!--span class="event-name" [ngClass]="e?.class" [ngStyle]="e?.style"> {{e.name}}</span-->
          <!--span class="event-continued-ellipsis" *ngIf="e.endDate.getDate() !== d.date.date()">...</span-->
        </button>
      </ul>
      <span class="ionic2-cal-day-of-month">{{d.date.date()}}</span>
      </button>
    </div>
  </div>
  <div class="selection-view">
    <!--{{ctrl.monthView.selectedDate?.date?.format('MMM Do YYYY')}}-->
    <!--ion-list class="event-list">
      <li [ngClass]="e.class" [ngStyle]="e.style" *ngFor="let e of ctrl.monthView?.selectedDate?.events">
        <span>{{e.startDate | date:"HH:mm"}}: </span>
        <ion-icon [ngStyle]="e?.iconStyle" [name]="e?.icon"></ion-icon> {{e.name}}
      </li>
    </ion-list-->

    <div class="spacing">
      <div class="list-title"><b>Legend</b></div>
      <div class="div-action">
        <button class="add-new-btn trippedcolor" small>
  Tripped
 </button>
        <button class="add-new-btn eventcolor">
  Event
 </button>
        <button class="add-new-btn warningcolor">
  Warning
 </button>
        <button class="add-new-btn servicecolor">
  Service
 </button>
      </div>
      <h3>{{daySession}}</h3>
      <br>
      <!--button ion-button small (click)="doAdd()" style="color:white">
    <span class="add-calendar-button-inner">
  +</span>
 </button-->


      <button class="add-new-btn" (click)="doAdd()">
  	<div class="algn-cent">
    	<ion-icon name="ios-add-circle-outline"></ion-icon>       
    </div>
  </button>


      <ion-list *ngIf="ctrl.monthView?.selectedDate?.events.length!=0">


        <ion-item-sliding *ngFor="let e of ctrl.monthView?.selectedDate?.events">

          <ion-item *ngIf="EVENTVIEWACCESS=='0'">
            <p style="color: red;
    position: relative;
    margin-top: 50%;
   text-align:center;
    font-size: 12pt;">{{permissionMessage}}</p>
          </ion-item>


          <ion-item *ngIf="e.event_type=='E'  && EVENTVIEWACCESS=='1'">
            <div>

              <h2 clear item-right><b>{{e.name}}  </b></h2>
            </div>
            <div>Time:{{e.event_time}}</div>
            <div style="white-space: normal">Location:{{e.event_location}}</div>
            <div style="white-space: normal">Remarks:{{e.event_remark}}</div>
            <div>Created By:{{e.event_addedby_name}}</div>
          </ion-item>

          <ion-item *ngIf="SERVICEVIEWACCESS=='0'">
            <p style="color: red;
    position: relative;
    margin-top: 50%;
   text-align:center;
    font-size: 12pt;">{{permissionMessage}}</p>
          </ion-item>
          <ion-item *ngIf="e.event_type=='S' && SERVICEVIEWACCESS=='1'">

            <div>

              <h2 clear item-right><b>Subject:{{e.name}}  </b></h2>
            </div>
            <div>Time:{{e.event_time}}</div>
            <div style="white-space: normal">Location:{{e.event_location}}</div>
            <div style="white-space: normal">Remarks:{{e.event_remark}}</div>
            <div>Created By:{{e.event_addedby_name}}</div>
          </ion-item>
          <ion-item *ngIf="ALARMVIEWACCESS=='0'">
            <p style="color: red;
    position: relative;
    margin-top: 50%;
   text-align:center;
    font-size: 12pt;">{{permissionMessage}}</p>
          </ion-item>
          <ion-item *ngIf="e.event_type=='A' && ALARMVIEWACCESS=='1'">

            <div>
              <h2 clear item-right><b>Alarm:{{e.name}}  </b></h2>
            </div>
            <div>Date & Time:{{e.event_time}}</div>
            <div style="white-space: normal">Location:{{e.event_location}}</div>
            <div style="white-space: normal">Remarks:{{e.event_remark}}</div>
          </ion-item>
          <ion-item-options>

            <button class="editcolor" (click)="doCalendarEdit(e,'Service')" *ngIf="e.event_type=='S' && SERVICEEDITACCESS==1">                      
                        <ion-icon name="create" class="icon-size"></ion-icon>
                    </button>
            <button class="trashcolor" (click)="doCalendarDelete(e,'Service')" *ngIf="e.event_type=='S' && SERVICEDELETEACCESS==1">                        
                         <ion-icon name="trash" class="icon-size"></ion-icon>
                    </button>




            <button class="editcolor" (click)="doCalendarEdit(e,'Event')" *ngIf="e.event_type=='E' && EVENTEDITACCESS==1">                      
                        <ion-icon name="create" class="icon-size"></ion-icon>
                    </button>
            <button class="trashcolor" (click)="doCalendarDelete(e,'Event')" *ngIf="e.event_type=='E' && EVENTDELETEACCESS==1">                        
                         <ion-icon name="trash" class="icon-size"></ion-icon>
                    </button>



            <button class="trashcolor" (click)="doCalendarDelete(e,'Alarm')" *ngIf="e.event_type=='A'  && ALARMDELETEACCESS==1">                        
                         <ion-icon name="trash" class="icon-size"></ion-icon>
                    </button>


            <button class="editcolor" (click)="doAlarmView(e.event_id)" *ngIf="e.event_type=='A'">                        
                        <ion-icon name="arrow-dropright"  class="icon-size"></ion-icon>
                    </button>


            <button class="editcolor" (click)="doCalendarView(e.event_id)" *ngIf="e.event_type=='E'">                        
                        <ion-icon name="arrow-dropright"  class="icon-size"></ion-icon>
                    </button>


          </ion-item-options>
        </ion-item-sliding>
      </ion-list>
      <ion-list>
        <ion-item *ngIf="totalCountEventDateWise==0">
          <div class="error">{{noeventtitle}}</div>
        </ion-item>
      </ion-list>
    </div>
  </div>