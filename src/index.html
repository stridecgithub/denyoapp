<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
	<meta charset="UTF-8">
	<title>Ionic App</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="format-detection" content="telephone=no">
	<meta name="msapplication-tap-highlight" content="no">

	<link rel="icon" type="image/x-icon" href="assets/icon/favicon.ico">
	<link rel="manifest" href="manifest.json">
	<meta name="theme-color" content="#4e8ef7">

	<!-- cordova.js required for cordova apps -->
	<script src="cordova.js"></script>

	<!-- un-comment this code to enable service worker
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('service worker installed'))
        .catch(err => console.error('Error', err));
    }
  </script>-->

	<link href="build/main.css" rel="stylesheet">

</head>

<body>


	<!-- Ionic's root component and where the app will load -->
	<ion-app></ion-app>

	<!-- The polyfills js is generated during the build process -->
	<script src="build/polyfills.js"></script>

	<!-- The bundle js is generated during the build process -->
	<script src="build/main.js"></script>
	<!--link href="http://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
  <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="http://strtheme.stridecdev.com/bootstrap-suggest.js"></script-->
	<!--link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css"-->
	<link href="ext/css/atmentioned.css" rel="stylesheet" type="text/css">
	<!--link rel="stylesheet" href="ext/css/bootstrap.css"-->
	<!--script src="ext/js/jquery-2.1.1.min.js"></script-->
	<!--script src="ext/js/bootstrap-suggest.js"></script-->
	<!--link rel="stylesheet" href=" http://denyoappv2.stridecdev.com/assets/css/mobile_unitdetails.css"-->
	<!--script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-sanitize.js"></script-->
	<!--script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="http://denyoappv2.stridecdev.com/assets/lib/jquery.nanoscroller/javascripts/jquery.nanoscroller.min.js" type="text/javascript"></script>
	<script src="http://denyoappv2.stridecdev.com/assets/js/main.js" type="text/javascript"></script>
	<script src="http://denyoappv2.stridecdev.com/assets/lib/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="http://denyoappv2.stridecdev.com/assets/lib/jquery.sparkline/jquery.sparkline.min.js" type="text/javascript"></script>
	<script src="http://denyoappv2.stridecdev.com/assets/js/app-charts-sparkline.js" type="text/javascript"></script>
	<script type="text/javascript" src="http://denyoappv2.stridecdev.com/assets/js/jquery-gauge.min.js"></script>


	<script>
		function appEvent(id) {
			if (id == 'enginedetails') {
				app.clickEnginedetails();
			}
			if (id == 'serviceinfo') {
				app.clickServicedetails();
			}
			if (id == 'alarmlog') {
				app.clickEventlogdetails();
			}
			if (id == 'eventandcomment') {
				app.clickCommentdetails();
			}
		}

		function settoast(code) {
			app.makeTrendlineToast(code);
		}

		$('.volt1gauge').gauge({
			values: {
				0: '250',
				20: '290',
				35: '330',
				60: '370',
				85: '410',
				100: '450',

			},
			colors: {
				0: '#df0000',
				15: '#ffca00',
				25: '#00ff50',
				75: '#00ff50',
				85: '#ffca00',
				95: '#df0000',
				'100': ''
			},
			angles: [
				180,
				360
			],
			lineWidth: 15,
			arrowWidth: 5,
			arrowColor: '#000',
			inset: false,
			value: 0
		});
		$('.current1gauge').gauge({
			values: {
				0: '0',
				20: '20',
				40: '40',
				60: '60',
				80: '80',
				100: '100',

			},
			colors: {
				0: '#00ff50',
				85: '#ffca00',
				90: '#df0000',
				'100': ''
			},
			angles: [
				180,
				360
			],
			lineWidth: 15,
			arrowWidth: 5,
			arrowColor: '#000',
			inset: false,
			value: 0
		});
		$('.freqgauge').gauge({
			values: {
				0: '40',
				25: '44',
				45: '48',
				60: '52',
				80: '56',
				100: '60',

			},
			colors: {
				0: '#df0000',
				15: '#ffca00',
				30: '#00ff50',
				80: '#ffca00',
				90: '#df0000',
				'100': ''
			},
			angles: [
				180,
				360
			],
			lineWidth: 15,
			arrowWidth: 5,
			arrowColor: '#000',
			inset: false,
			value: 0
		});
		$('.enginespeedgauge').gauge({
			values: {
				0: '1200',
				20: '1320',
				40: '1440',
				60: '1560',
				80: '1680',
				100: '1800',

			},
			colors: {
				0: '#df0000',
				15: '#ffca00',
				30: '#00ff50',
				60: '#00ff50',
				80: '#ffca00',
				90: '#df0000',
				'100': ''
			},
			angles: [
				180,
				360
			],
			lineWidth: 15,
			arrowWidth: 5,
			arrowColor: '#000',
			inset: false,
			value: 0
		});
		$('.fuellevelgauge').gauge({
			values: {
				0: '0',
				20: '20',
				40: '40',
				60: '60',
				80: '80',
				100: '100',

			},
			colors: {
				0: '#df0000',
				15: '#ffca00',
				30: '#00ff50',
				80: '#ffca00',
				90: '#df0000',
				'100': ''
			},
			angles: [
				180,
				360
			],
			lineWidth: 15,
			arrowWidth: 5,
			arrowColor: '#000',
			inset: false,
			value: 0
		});
		$('.loadpowergauge').gauge({
			values: {
				0: '0',
				20: '12',
				40: '24',
				60: '36',
				80: '48',
				100: '60',

			},
			colors: {
				0: '#df0000',
				20: '#ffca00',
				40: '#00ff50',
				80: '#ffca00',
				85: '#df0000',
				'100': ''
			},
			angles: [
				180,
				360
			],
			lineWidth: 15,
			arrowWidth: 5,
			arrowColor: '#000',
			inset: false,
			value: 0
		});




		window.setInterval(function () {

			var token = $('input[name=_token]').val();
			var unitid = "GEN0002";

			$.ajax({
				headers: { 'X-CSRF-TOKEN': token },
				method: "POST",
				url: "http://denyoappv2.stridecdev.com/unitdetailsforinterval",
				data: { unitid: unitid },
				success: function (data) {
					console.log("kannan" + data);
					//alert(data);
					if (data != '') {
						var breakeroff = "http://denyoappv2.stridecdev.com/assets/images/breaker_vector.png";
						var breakeron = "http://denyoappv2.stridecdev.com/assets/images/breaker_vector_on.png";
						var alertalarm = "http://denyoappv2.stridecdev.com/images/alarmalert.gif";
						var alertalarmno = "http://denyoappv2.stridecdev.com/images/alarm.png";

						var fullstring = data.split("|---");
						var fullstr = fullstring[0].split("|");
						//alert(fullstr);
						var button = fullstring[1];
						//alert(button);
						var alarm = fullstring[2].split("#");
						var comstatus = fullstring[3].split("#");

						var currentstate = fullstring[4];
						//alert(comstatus);
						//console.log(alarm);
						$("#generatorstatus").html(comstatus[1]);
						if (comstatus[1] == "Offline") {

							$("#unitstate").html(comstatus[1]);
							$("#unitstate").removeClass("tripped");
							$("#unitstate").removeClass("warningg");
							$("#unitstate").removeClass("runningg");
							$("#unitstate").removeClass("ready");
							$("#unitstate").removeClass("coolings");
							$("#unitstate").removeClass("crankings");
							$("#unitstate").addClass("offline");
							$("#STARTBTNd").css('display', '');
							if (alarm[1] == "1") {
								$("#alarmalert").attr('src', alertalarm);
							}
							else {
								$("#alarmalert").attr('src', alertalarmno);
							}
						}
						else {
							$("#unitstate").removeClass("offline");
							$("#unitstate").removeClass("tripped");
							$("#unitstate").removeClass("warningg");
							$("#unitstate").removeClass("runningg");
							$("#unitstate").removeClass("ready");
							$("#unitstate").removeClass("coolings");
							//$("#unitstate").removeClass("crankings");
							if (alarm[1] == "1") {
								$("#unitstate").html("Warning");
								$("#unitstate").addClass("warningg");
								$("#alarmalert").attr('src', alertalarm);
							}
							else {

								//$("#unitstate").html("Tripped");
								//$("#unitstate").addClass("crankings");
								if (currentstate == "0") {
									//$("#unitstate").html("Tripped");
									$("#unitstate").addClass("tripped");
								}
								if (currentstate == "1") {
									//$("#unitstate").html("Ready");
									$("#unitstate").addClass("ready");
								}
								else if (currentstate == "2") {
									$("#unitstate").html("Not Ready");
									$("#unitstate").addClass("tripped");
								}
								else if (currentstate == "3") {
									//$("#unitstate").html("Cranking");
									$("#unitstate").addClass("crankings");
								}
								else if (currentstate == "4") {
									$("#unitstate").html("Cranking");
									$("#unitstate").addClass("crankings");
								}
								else if (currentstate == "6") {
									$("#unitstate").html("Cranking");
									$("#unitstate").addClass("crankings");
								}
								else if (currentstate == "7") {
									if (alarm[1] == "1") {
										$("#unitstate").html("Warning");
										$("#unitstate").addClass("warningg");
									}
									else {
										$("#unitstate").html("Running");
										$("#unitstate").addClass("runningg");
									}
									//$("#breakerstate").attr("src", breakeron);
								}
								else if (currentstate == "10") {
									$("#unitstate").html("Cooling");
									$("#unitstate").addClass("coolings");
								}
								else if (individualData[1] == "12") {
									//$("#unitstate").html("Tripped");
									$("#unitstate").addClass("tripped");
								}
								$("#alarmalert").attr('src', alertalarmno);
							}
						}

						//alert(comstatus[1]);
						//alert(button);.....STARTBTN#1|STOPBTN#0|FAULTBTN#0|MANBTN#1|AUTOBTN#1|OFFBTN#0
						if (button != '') {
							var visiblebutton = button.split("|");
							for (var k = 0; k < visiblebutton.length; k++) {
								var individualButtonData = visiblebutton[k].split("#");
								//alert(individualButtonData);// STARTBTN,1
								var buttonlabel = individualButtonData[0];
								var buttonvalue = individualButtonData[1];
								//id's for display none buttons..
								var displaynonebuttonlabel = buttonlabel + "d";
								//alert(displaynonebuttonlabel);
								if (buttonvalue == '1') {
									document.getElementById(buttonlabel).style.display = "block";
									document.getElementById(displaynonebuttonlabel).style.display = "none";
								}
								else {
									if (alarm[1] == "1" && buttonlabel == "FAULTBTN") {
										document.getElementById(buttonlabel).style.display = "block";
										document.getElementById(displaynonebuttonlabel).style.display = "none";
									}
									else {
										document.getElementById(buttonlabel).style.display = "none";
										document.getElementById(displaynonebuttonlabel).style.display = "block";
									}
								}
							}
						}

						if (comstatus[1] == "Online") {
							//alert(fullstr);
							var tmpval = '';
							var newteststring = fullstr;
							for (var i = 0; i < fullstr.length; i++) {


								var iData = fullstr[i];
								var individualData = iData.split("#");
								//alert(individualData);

								document.getElementById(individualData[0]).value = individualData[1];

								if (individualData[0] == "current1") {
									$("#c").html(individualData[1]);

									var gaugeval = '';

									if (individualData[1] == 0)
										gaugeval = 0;
									else
										gaugeval = individualData[1];

									var gauge = new Gauge($('.current1guage'), {
										values: {
											0: '0', 20: '20', 40: '40', 60: '60', 80: '80', 100: '100'
										},
										colors: {
											0: '#00ff50', 85: '#ffca00', 90: '#df0000', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});


								}
								if (individualData[0] == "current2") {

									$("#c1").html(individualData[1]);

									var gaugeval = '';

									if (individualData[1] == 0)
										gaugeval = 0;
									else
										gaugeval = individualData[1];

									var gauge = new Gauge($('.current2guage'), {
										values: {
											0: '0', 20: '20', 40: '40', 60: '60', 80: '80', 100: '100'
										},
										colors: {
											0: '#00ff50', 85: '#ffca00', 90: '#df0000', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});
								}
								if (individualData[0] == "current3") {
									$("#c2").html(individualData[1]);

									var gaugeval = '';

									if (individualData[1] == 0)
										gaugeval = 0;
									else
										gaugeval = individualData[1];

									var gauge = new Gauge($('.current3guage'), {
										values: {
											0: '0', 20: '20', 40: '40', 60: '60', 80: '80', 100: '100'
										},
										colors: {
											0: '#00ff50', 85: '#ffca00', 90: '#df0000', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});
								}
								if (individualData[0] == "volt1") {
									$("#voltagespan").html(individualData[1]);

									// Low val = 250, High val - 450, range - 200
									var gaugeval = '';

									if (individualData[1] <= 250)
										gaugeval = 0;
									else
										gaugeval = ((individualData[1] - 250) / 200) * 100;

									var gauge = new Gauge($('.volt1guage'), {
										values: {
											0: '250', 20: '290', 40: '330', 60: '370', 80: '410', 100: '450'
										},
										colors: {
											0: '#df0000', 15: '#ffca00', 25: '#00ff50', 75: '#00ff50', 85: '#ffca00', 95: '#df0000', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});



								}
								if (individualData[0] == "volt2") {

									$("#voltagespan").html(individualData[1]);
									var gaugeval = '';

									// Low val = 250, High val - 450, range - 200
									var gaugeval = '';

									if (individualData[1] <= 250)
										gaugeval = 0;
									else
										gaugeval = ((individualData[1] - 250) / 200) * 100;

									var gauge = new Gauge($('.volt2guage'), {
										values: {
											0: '250', 20: '290', 40: '330', 60: '370', 80: '410', 100: '450'
										},
										colors: {
											0: '#df0000', 15: '#ffca00', 25: '#00ff50', 75: '#00ff50', 85: '#ffca00', 95: '#df0000', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});
								}
								if (individualData[0] == "volt3") {

									$("#voltagespan").html(individualData[1]);
									// Low val = 250, High val - 450, range - 200
									var gaugeval = '';

									if (individualData[1] <= 250)
										gaugeval = 0;
									else
										gaugeval = ((individualData[1] - 250) / 200) * 100;

									var gauge = new Gauge($('.volt3guage'), {
										values: {
											0: '250', 20: '290', 40: '330', 60: '370', 80: '410', 100: '450'
										},
										colors: {
											0: '#df0000', 15: '#ffca00', 25: '#00ff50', 75: '#00ff50', 85: '#ffca00', 95: '#df0000', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});
								}
								if (individualData[0] == "fuellevel") {
									$("#fl").html(individualData[1]);
									$("#flu").html(individualData[1]);
									//var gauge = new Gauge($('.fuellevelguage'), {value:individualData[1]});

									var gaugeval = '';

									if (individualData[1] == 0)
										gaugeval = 0;
									else
										gaugeval = individualData[1];

									var gauge = new Gauge($('.fuellevelguage'), {
										values: {
											0: '0', 20: '20', 40: '40', 60: '60', 80: '80', 100: '100'
										},
										colors: {
											0: '#ffca00', 6: '#00ff50', 20: '#00ff50', 40: '#00ff50', 60: '#00ff50', 80: '#00ff50', 100: ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});


								}
								if (individualData[0] == "engspeed") {
									$("#espan").html(individualData[1]);

									var gaugeval = '';

									if (individualData[1] <= 1200)
										gaugeval = 0;
									else if (individualData[1] >= 1800)
										gaugeval = 100;
									else
										gaugeval = (((individualData[1] - 1200) / 600) * 100);

									var gauge = new Gauge($('.enginespeedguage'), {
										values: {
											0: '1200', 20: '1320', 40: '1440', 60: '1560', 80: '1680', 100: '1800'
										},
										colors: {
											0: '#df0000', 15: '#ffca00', 30: '#00ff50', 80: '#ffca00', 90: '#df0000', '100': ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});




								}
								if (individualData[0] == "loadpower") {
									$("#lp").html(individualData[1]);
									$("#loadpowerspan").html(individualData[1]);
									var gaugeval = '';

									if (individualData[1] == 0)
										gaugeval = 0;
									else
										gaugeval = ((individualData[1] - 40) / 11) * 100;

									var gauge = new Gauge($('.loadpower1guage'), {
										values: {
											0: '0', 20: '12', 40: '24', 60: '36', 80: '48', 100: '60'
										},
										colors: {
											0: '#00ff50', 20: '#00ff50', 40: '#00ff50', 80: '#ffca00', 85: '#df0000'
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});

								}

								if (individualData[0] == "batteryvoltage") {
									$("#batvoltage").html(individualData[1]);
									//tmpval = parseInt(individualData[1]) + 166;
									if (individualData[1] <= 0)
										tmpval = 0;
									else
										tmpval = (parseInt(individualData[1]) * 10) + 45;
									//alert(tmpval);
									$("#batterybar").css("margin-top", "-" + tmpval + "px");
								}
								if (individualData[0] == "loadpowerfactor") {
									$("#pfactor").html(individualData[1]);


									if (individualData[1] < 10)
										tmpval = "-" + parseInt(((individualData[1] * 10) * 24.5) + 40);
									else
										tmpval = "-" + parseInt((individualData[1] * 24.5) + 40);
									//alert(tmpval);
									$("#powergreen").css("margin-top", tmpval + "px");


								}
								if (individualData[0] == "oilpressure") {
									$("#op").html(individualData[1]);
									if (individualData[1] == 0)
										tmpval = '-40';
									else
										tmpval = "-" + parseInt((individualData[1] * 24.5) + 100);

									$("#oilbar").css("margin-top", tmpval + "px");

								}
								if (individualData[0] == "collanttemp") {
									$("#cot").html(individualData[1]);
									tmpval = "-" + parseInt(((individualData[1] * 24.5) + 40) / 10);

									$("#coolbar").css("margin-top", tmpval + "px");
								}
								if (individualData[0] == "runninghr")
									$("#runninghr").html(individualData[1]);
								if (individualData[0] == "freq") {

									$("#f").html(individualData[1]);

									var gaugeval = '';

									if (individualData[1] <= 40)
										gaugeval = 0;
									else if (individualData[1] >= 60)
										gaugeval = 100;
									else
										gaugeval = (((individualData[1] - 40) / 20) * 100);

									var gauge = new Gauge($('.frequency'), {
										values: {
											0: '40', 20: '44', 40: '48', 60: '52', 80: '56', 100: '60'
										},
										colors: {
											0: '#df0000', 15: '#ffca00', 30: '#00ff50', 80: '#ffca00', 90: '#df0000', '100': ''
										},
										angles: [
											180,
											360
										],
										lineWidth: 15,
										arrowWidth: 5,
										arrowColor: '#000000',
										inset: false,
										value: gaugeval
									});
								}
								if (individualData[0] == "enginestate") {
									//alert(individualData[0]);
									$("#unitstate").removeClass("offline");
									$("#unitstate").removeClass("tripped");
									$("#unitstate").removeClass("warningg");
									$("#unitstate").removeClass("runningg");
									$("#unitstate").removeClass("ready");
									$("#unitstate").removeClass("cooling");
									$("#unitstate").removeClass("crankings");
									var statevalue = "Init";
									if (individualData[1] == "0") {
										statevalue = "Init";
										$("#unitstate").html("Init");
										$("#unitstate").addClass("tripped");
										//$("#breakerstate").attr("src", breakeroff);
									}
									if (individualData[1] == "1") {
										statevalue = "Ready";
										$("#unitstate").html("Ready");
										$("#unitstate").addClass("ready");
										$("#breakerstate").attr("src", breakeroff);
									}
									else if (individualData[1] == "2") {
										statevalue = "Not Ready";
										$("#unitstate").html("Not Ready");
										$("#unitstate").addClass("tripped");
										$("#breakerstate").attr("src", breakeroff);
									}
									else if (individualData[1] == "3") {
										statevalue = "Prestart";
										$("#unitstate").html("Cranking");
										$("#unitstate").addClass("crankings");
									}
									else if (individualData[1] == "4") {
										statevalue = "Pre-Start";
										$("#unitstate").html("Cranking");
										$("#unitstate").addClass("crankings");
									}
									else if (individualData[1] == "5")
										statevalue = "Pause";
									else if (individualData[1] == "6") {
										statevalue = "Starting";
										$("#unitstate").html("Cranking");
										$("#unitstate").addClass("crankings");
									}
									else if (individualData[1] == "7") {
										statevalue = "Running";
										if (alarm[1] == "1") {
											$("#unitstate").html("Warning");
											$("#unitstate").addClass("warningg");
										}
										else {
											$("#unitstate").html("Running");
											$("#unitstate").addClass("runningg");
										}
										//$("#breakerstate").attr("src", breakeron);
									}
									else if (individualData[1] == "8")
										statevalue = "Loaded";
									else if (individualData[1] == "9")
										statevalue = "Soft unld";
									else if (individualData[1] == "10") {
										statevalue = "Cooling";
										$("#unitstate").html("Cooling");
										$("#unitstate").addClass("crankings");
									}
									else if (individualData[1] == "11")
										statevalue = "Stop";
									else if (individualData[1] == "12") {
										statevalue = "Shutdown";
										$("#unitstate").html("Tripped");
										$("#unitstate").addClass("tripped");
									}
									else if (individualData[1] == "13")
										statevalue = "Ventil";
									else if (individualData[1] == "14")
										statevalue = "EmergMan";
									else if (individualData[1] == "15")
										statevalue = "Soft Load";
									else if (individualData[1] == "16")
										statevalue = "Wait Stop";
									else {
										statevalue = "Init";
										$("#unitstate").html("Init");
										$("#unitstate").addClass("tripped");
									}
									//$("#generatorstatus").html(statevalue);
								}
							} // end for fullstr
						}
						else {
							$("#breakerstate").attr("src", breakeroff);
						}
					}
				}
				//,error: function(ts) { alert(ts.responseText) }
			});

		}, 1000); //1000
	</script-->
</body>

</html>